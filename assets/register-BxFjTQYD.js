import{_ as z,b as j,r as a,c as h,a as s,w as G,n as H,t as n,e as u,v as f,F as J,k as K,l as O,m as Q,f as W,g as X,h as Y,p as Z,o as _,u as ee,i as se,S as te}from"./index-BMCsW35F.js";import{s as ae}from"./successErrorCard-BYWK69lD.js";import"./feather-C4m1glYC.js";const le={class:"register-page"},oe={class:"container"},ne={"data-feather":"image",class:"iconStyle"},re={class:"title"},ie={class:"input-group"},ue=["placeholder"],de={class:"input-group address-input"},ce=["disabled","placeholder"],pe={key:0,class:"dropdown"},ve=["onClick"],me={class:"input-group"},ge=["placeholder"],he={class:"input-group"},fe=["placeholder"],_e={class:"input-group"},ye={value:"",disabled:""},be={value:"en"},we={value:"es"},$e={class:"terms-container"},ke={class:"terms-checkbox"},Se={class:"terms-text"},Te={href:"https://www.trueque.art/#/privacy",target:"_blank"},Ce=["disabled"],Ie={__name:"register",setup(Le){const{t:p,locale:U}=j(),q=new te,I=ee(),d=a("success"),r=a(""),o=a(!1),v=a(!1),L=se(),y=a(""),i=a(""),b=a(""),w=a(""),m=a(""),$=a(null),k=a(null),g=a([]);let V=null;const E=a(null),c=a(),S=a(!1),T=a(!1),P=()=>{E.value.click()},F=e=>{const t=Array.from(e.target.files);t.length>0?(c.value=t,S.value=!0,T.value=!1):(c.value=null,S.value=!1)},A=()=>{clearTimeout(V),V=setTimeout(R,500)},N=()=>{I.push({name:"login"})},M=e=>{U.value=e.target.value},C=a(!1),R=async()=>{if(!(i.value.length<3)){C.value=!0;try{const e=await Z.get("https://photon.komoot.io/api/",{params:{q:i.value,limit:5}});g.value=e.data.features.map(t=>({display_name:t.properties.housenumber&&t.properties.street?`${t.properties.housenumber} ${t.properties.street}, ${t.properties.city}`:`${t.properties.name}, ${t.properties.city}`,lat:t.geometry.coordinates[1],lon:t.geometry.coordinates[0]}))}catch(e){console.error("Error fetching address suggestions",e)}C.value=!1}},x=e=>{i.value=e.display_name,$.value=e.lat,k.value=e.lon,g.value=[]},B=()=>{if(v.value){if(!c.value||c.value.length===0){T.value=!0,r.value=p("Please upload a profile image"),d.value="error",o.value=!0,setTimeout(()=>{o.value=!1},2800);return}if(!$.value||!k.value){r.value=p("Please select a valid address from the dropdown."),d.value="error",o.value=!0,setTimeout(()=>{o.value=!1},2800);return}if(!m.value){r.value=p("Please select a language."),d.value="error",o.value=!0,setTimeout(()=>{o.value=!1},2800);return}L.commit("setLoading",!0),q.register({name:y.value,address:{street:i.value,latitude:$.value,longitude:k.value},email:b.value,password:w.value,language:m.value,profileImg:c.value}).then(()=>{d.value="success",r.value=p("Account created! Please verify your email."),o.value=!0,setTimeout(()=>{o.value=!1},2800),I.push({name:"verifyEmail"})}).catch(e=>{r.value=e,o.value=!0,setTimeout(()=>{o.value=!1},2800)}).finally(()=>{L.commit("setLoading",!1)})}};return(e,t)=>(_(),h("div",le,[s("div",oe,[s("form",{onSubmit:G(B,["prevent"]),class:"form"},[s("div",{class:H(["cont_logo",{selected:S.value,"error-border":T.value}]),id:"ImageInput",onClick:P},[s("i",ne,[s("input",{type:"file",ref_key:"fileInput",ref:E,style:{display:"none"},required:"",onChange:F,accept:"image/*",multiple:""},null,544)])],2),s("h1",re,n(e.$t("Register")),1),s("div",ie,[u(s("input",{type:"text",id:"name","onUpdate:modelValue":t[0]||(t[0]=l=>y.value=l),required:"",class:"inputLogin",placeholder:e.$t("Full Name")},null,8,ue),[[f,y.value]])]),s("div",de,[u(s("input",{type:"text",id:"city","onUpdate:modelValue":t[1]||(t[1]=l=>i.value=l),onInput:A,disabled:C.value,required:"",class:"inputLogin",placeholder:e.$t("Enter your address")},null,40,ce),[[f,i.value]]),g.value.length?(_(),h("div",pe,[(_(!0),h(J,null,K(g.value,(l,D)=>(_(),h("div",{key:D,class:"dropdown-item",onClick:Ve=>x(l)},n(l.display_name),9,ve))),128))])):O("",!0)]),s("div",me,[u(s("input",{type:"email",id:"email","onUpdate:modelValue":t[2]||(t[2]=l=>b.value=l),required:"",class:"inputLogin",placeholder:e.$t("E-mail")},null,8,ge),[[f,b.value]])]),s("div",he,[u(s("input",{type:"password",id:"password","onUpdate:modelValue":t[3]||(t[3]=l=>w.value=l),required:"",class:"inputLogin",placeholder:e.$t("Password")},null,8,fe),[[f,w.value]])]),s("div",_e,[u(s("select",{id:"language","onUpdate:modelValue":t[4]||(t[4]=l=>m.value=l),class:"inputLogin",onChange:M},[s("option",ye,n(e.$t("Language")),1),s("option",be,n(e.$t("English")),1),s("option",we,n(e.$t("Spanish")),1)],544),[[Q,m.value]])]),s("div",$e,[s("label",ke,[u(s("input",{type:"checkbox",id:"terms","onUpdate:modelValue":t[5]||(t[5]=l=>v.value=l)},null,512),[[W,v.value]]),s("span",Se,[X(n(e.$t("I agree to the"))+" ",1),s("a",Te,n(e.$t("Terms of Service and Privacy Policy")),1)])])]),s("button",{type:"submit",class:"submit-button",disabled:!v.value},n(e.$t("Sign Up")),9,Ce),s("p",{class:"login-link",onClick:N},n(e.$t("Already have an account?")),1)],32)]),Y(ae,{type:d.value,text:r.value,launch:o.value},null,8,["type","text","launch"])]))}},Pe=z(Ie,[["__scopeId","data-v-fa278366"]]);export{Pe as default};
