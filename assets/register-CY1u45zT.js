import{_ as z,b as G,r as a,c as m,a as s,w as H,n as J,t as o,e as r,v as g,F as K,p as O,i as U,q as Q,f as W,g as X,h as Y,j as Z,s as ee,o as d,u as se,l as te,S as ae}from"./index-CZ9WfSIq.js";import{s as le}from"./successErrorCard-D8HcLNe4.js";const oe={class:"register-page"},ne={class:"container"},ie={"data-feather":"image",class:"iconStyle"},re={class:"title"},ue={class:"input-group"},de=["placeholder"],ce={class:"input-group address-input"},pe=["disabled","placeholder"],ve={key:0,class:"dropdown"},me=["onClick"],ge={class:"input-group"},he=["placeholder"],_e={class:"input-group"},ye=["placeholder"],fe={class:"input-group"},be={value:"",disabled:""},we={value:"en"},ke={value:"es"},$e={class:"terms-container"},Ce={class:"terms-checkbox"},Ie={class:"terms-text"},Se={href:"https://www.trueque.art/#/privacy",target:"_blank"},Te=["disabled"],Ve={__name:"register",setup(Ee){const{t:I,locale:q}=G(),F=new ae,S=se(),h=a("success"),c=a(""),n=a(!1),_=a(!1),p=a(!1),y=a(""),i=a(""),f=a(""),b=a(""),w=a(""),T=a(null),V=a(null),v=a([]);let E=null;const L=a(null),u=a(),k=a(!1),$=a(!1),A=()=>{L.value.click()},N=e=>{const t=Array.from(e.target.files);t.length>0?(u.value=t,k.value=!0,$.value=!1):(u.value=null,k.value=!1)},P=()=>{clearTimeout(E),E=setTimeout(R,500)},B=()=>{S.push({name:"login"})},M=e=>{q.value=e.target.value},C=a(!1),R=async()=>{if(!(i.value.length<3)){C.value=!0;try{const e=await ee.get("https://photon.komoot.io/api/",{params:{q:i.value,limit:5}});v.value=e.data.features.map(t=>({display_name:t.properties.housenumber&&t.properties.street?`${t.properties.housenumber} ${t.properties.street}, ${t.properties.city}`:`${t.properties.name}, ${t.properties.city}`,lat:t.geometry.coordinates[1],lon:t.geometry.coordinates[0]}))}catch(e){console.error("Error fetching address suggestions",e)}C.value=!1}},x=e=>{i.value=e.display_name,T.value=e.lat,V.value=e.lon,v.value=[]},D=()=>{if(p.value){if(!u.value||u.value.length===0){$.value=!0,c.value=I("Please upload a profile image"),h.value="error",n.value=!0,setTimeout(()=>{n.value=!1},2800);return}_.value=!0,F.register({name:y.value,address:{street:i.value,latitude:T.value,longitude:V.value},email:f.value,password:b.value,language:w.value,profileImg:u.value}).then(()=>{h.value="success",c.value=I("Account created! Please verify your email."),n.value=!0,setTimeout(()=>{n.value=!1},2800),S.push({name:"verifyEmail"})}).catch(e=>{c.value=e,n.value=!0,setTimeout(()=>{n.value=!1},2800)}).finally(()=>{_.value=!1})}};return(e,t)=>(d(),m("div",oe,[s("div",ne,[s("form",{onSubmit:H(D,["prevent"]),class:"form"},[s("div",{class:J(["cont_logo",{selected:k.value,"error-border":$.value}]),id:"ImageInput",onClick:A},[s("i",ie,[s("input",{type:"file",ref_key:"fileInput",ref:L,style:{display:"none"},required:"",onChange:N,accept:"image/*",multiple:""},null,544)])],2),s("h1",re,o(e.$t("Register")),1),s("div",ue,[r(s("input",{type:"text",id:"name","onUpdate:modelValue":t[0]||(t[0]=l=>y.value=l),required:"",class:"inputLogin",placeholder:e.$t("Full Name")},null,8,de),[[g,y.value]])]),s("div",ce,[r(s("input",{type:"text",id:"city","onUpdate:modelValue":t[1]||(t[1]=l=>i.value=l),onInput:P,disabled:C.value,required:"",class:"inputLogin",placeholder:e.$t("Enter your address")},null,40,pe),[[g,i.value]]),v.value.length?(d(),m("div",ve,[(d(!0),m(K,null,O(v.value,(l,j)=>(d(),m("div",{key:j,class:"dropdown-item",onClick:Le=>x(l)},o(l.display_name),9,me))),128))])):U("",!0)]),s("div",ge,[r(s("input",{type:"email",id:"email","onUpdate:modelValue":t[2]||(t[2]=l=>f.value=l),required:"",class:"inputLogin",placeholder:e.$t("E-mail")},null,8,he),[[g,f.value]])]),s("div",_e,[r(s("input",{type:"password",id:"password","onUpdate:modelValue":t[3]||(t[3]=l=>b.value=l),required:"",class:"inputLogin",placeholder:e.$t("Password")},null,8,ye),[[g,b.value]])]),s("div",fe,[r(s("select",{id:"language","onUpdate:modelValue":t[4]||(t[4]=l=>w.value=l),class:"inputLogin",onChange:M},[s("option",be,o(e.$t("Language")),1),s("option",we,o(e.$t("English")),1),s("option",ke,o(e.$t("Spanish")),1)],544),[[Q,w.value]])]),s("div",$e,[s("label",Ce,[r(s("input",{type:"checkbox",id:"terms","onUpdate:modelValue":t[5]||(t[5]=l=>p.value=l)},null,512),[[W,p.value]]),s("span",Ie,[X(o(e.$t("I agree to the"))+" ",1),s("a",Se,o(e.$t("Terms of Service and Privacy Policy")),1)])])]),s("button",{type:"submit",class:"submit-button",disabled:!p.value},o(e.$t("Sign Up")),9,Te),s("p",{class:"login-link",onClick:B},o(e.$t("Already have an account?")),1)],32)]),_.value?(d(),Y(te,{key:0})):U("",!0),Z(le,{type:h.value,text:c.value,launch:n.value},null,8,["type","text","launch"])]))}},Fe=z(Ve,[["__scopeId","data-v-be5ed1b1"]]);export{Fe as default};
