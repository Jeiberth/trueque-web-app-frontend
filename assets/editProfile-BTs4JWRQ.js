import{_ as x,b as O,r as a,C as W,D as j,q as z,d as G,c as y,a as t,t as u,w as H,e as _,v as C,F as J,k as K,l as Q,m as X,h as Y,i as Z,p as ee,o as w,u as se,S as te}from"./index-VZJWoiHj.js";import{s as ae}from"./successErrorCard-CsDnWBLS.js";import"./feather-DGZv_OKY.js";const le={class:"landing-page"},oe={class:"container"},ne={"data-feather":"image",class:"iconStyle"},ie={class:"title"},re={class:"input-group"},ue=["placeholder"],ce={class:"input-group"},de=["disabled","placeholder"],pe={key:0,class:"dropdown"},ve=["onClick"],me={class:"input-group"},ge=["placeholder"],he={class:"input-group"},fe={value:"",disabled:""},ye={value:"en"},_e={value:"es"},we={type:"submit",class:"submit-button"},Ue={__name:"editProfile",setup(Ie){const{t:g,locale:D}=O(),o=Z(),F=new te,L=se(),c=a("success"),d=a(""),n=a(!1);o.getters.getUserId;const p=a("");a("");const v=a("");a("");const m=a("");W(["Alice","Bob","Charlie","Diana"]);const b=a(null),h=a(),U=a(!1),k=a(!1),f=a([]),r=a(""),S=a(null),E=a(null),V=()=>{clearTimeout(T),T=setTimeout(B,1e3)},q=e=>{D.value=e.target.value},I=a(!1),B=async()=>{if(!(r.value.length<3)){I.value=!0;try{const e=await ee.get("https://photon.komoot.io/api/",{params:{q:r.value,limit:5}});f.value=e.data.features.map(s=>({display_name:s.properties.housenumber&&s.properties.street?`${s.properties.housenumber} ${s.properties.street}, ${s.properties.city}`:`${s.properties.name}, ${s.properties.city}`,lat:s.geometry.coordinates[1],lon:s.geometry.coordinates[0]}))}catch(e){console.error("Error fetching address suggestions",e)}I.value=!1}};let T=null;const R=e=>{r.value=e.display_name,S.value=e.lat,E.value=e.lon,f.value=[]};j(()=>{o.commit("setLoading",!0)});const i=z(()=>o.getters.getUserDetails);G(async()=>{if(o.commit("setLoading",!0),i.value)p.value=i.value.user.name,r.value=i.value.user.location,v.value=i.value.user.email,m.value=i.value.user.language;else try{await o.dispatch("fetchUserDetails"),p.value=i.value.user.name,r.value=i.value.user.location,v.value=i.value.user.email,m.value=i.value.user.language}catch(e){console.error("Failed to load user details:",e)}o.commit("setLoading",!1)});const A=()=>{b.value.click()},M=e=>{const s=Array.from(e.target.files);if(s.length>0){if(!s.every($=>$.type.startsWith("image/"))){d.value=g("Only image files are allowed."),c.value="error",n.value=!0,setTimeout(()=>{n.value=!1},2800),h.value=null,U.value=!1,k.value=!0;return}h.value=s,U.value=!0,k.value=!1}else h.value=null,U.value=!1},N=()=>{L.push({name:"resetPassword"})},P=async()=>{o.commit("setLoading",!0),await F.updateUser({name:p.value,address:{street:r.value,latitude:S.value,longitude:E.value},email:v.value,language:m.value,profileImg:h.value}).then(e=>{e.success?(o.commit("setLoading",!1),c.value="success",d.value=g("User Successfully Updated"),n.value=!0,setTimeout(()=>{n.value=!1},2800),L.push({name:"swaps"})):(o.commit("setLoading",!1),c.value="error",d.value=g("Error Updating User"),n.value=!0,setTimeout(()=>{n.value=!1},2800))}).catch(e=>{o.commit("setLoading",!1),c.value="error",d.value=g("Error Updating User"),n.value=!0,setTimeout(()=>{n.value=!1},2800)})};return(e,s)=>(w(),y("div",le,[t("div",oe,[t("div",{class:"cont_logo selected",id:"ImageInput",onClick:A},[t("i",ne,[t("input",{type:"file",ref_key:"fileInput",ref:b,style:{display:"none"},required:"",onChange:M,accept:"image/*",multiple:""},null,544)])]),t("h1",ie,u(e.$t("Edit Profile")),1),t("form",{onSubmit:H(P,["prevent"]),class:"form"},[t("div",re,[_(t("input",{type:"text",id:"name","onUpdate:modelValue":s[0]||(s[0]=l=>p.value=l),required:"",class:"inputLogin",placeholder:e.$t("Full Name")},null,8,ue),[[C,p.value]])]),t("div",ce,[_(t("input",{type:"text",id:"city","onUpdate:modelValue":s[1]||(s[1]=l=>r.value=l),onInput:V,disabled:I.value,required:"",class:"inputLogin",placeholder:e.$t("Enter your address")},null,40,de),[[C,r.value]]),f.value.length?(w(),y("div",pe,[(w(!0),y(J,null,K(f.value,(l,$)=>(w(),y("div",{key:$,class:"dropdown-item",onClick:$e=>R(l)},u(l.display_name),9,ve))),128))])):Q("",!0)]),t("div",me,[_(t("input",{type:"email",id:"email","onUpdate:modelValue":s[2]||(s[2]=l=>v.value=l),required:"",class:"inputLogin",placeholder:e.$t("E-mail")},null,8,ge),[[C,v.value]])]),t("div",he,[_(t("select",{id:"language","onUpdate:modelValue":s[3]||(s[3]=l=>m.value=l),class:"inputLogin",onChange:q},[t("option",fe,u(e.$t("Language")),1),t("option",ye,u(e.$t("English")),1),t("option",_e,u(e.$t("Spanish")),1)],544),[[X,m.value]])]),t("button",we,u(e.$t("Confirm")),1),t("p",{class:"reset-password-link",onClick:N},u(e.$t("Reset password")),1)],32)]),Y(ae,{type:c.value,text:d.value,launch:n.value},null,8,["type","text","launch"])]))}},ke=x(Ue,[["__scopeId","data-v-886e8e7f"]]);export{ke as default};
