import{_ as G,b as z,r as a,E as H,G as J,x as K,d as O,c as f,a as t,t as u,w as Q,e as _,v as k,F as W,p as X,i as E,q as Y,h as Z,j as ee,k as se,s as te,o as v,u as ae,l as le,S as oe}from"./index-CJepchhu.js";import{s as ne}from"./successErrorCard-QDg6fcS6.js";const ie={class:"landing-page"},re={class:"container"},ue={"data-feather":"image",class:"iconStyle"},ce={class:"title"},de={class:"input-group"},pe=["placeholder"],ve={class:"input-group"},me=["disabled","placeholder"],ge={key:0,class:"dropdown"},he=["onClick"],fe={class:"input-group"},_e=["placeholder"],ye={class:"input-group"},we={value:"",disabled:""},Ue={value:"en"},ke={value:"es"},$e={type:"submit",class:"submit-button"},Le={__name:"editProfile",setup(be){const{t:y,locale:T}=z(),l=se(),F=new oe,$=ae(),m=a("success"),g=a(""),r=a(!1);l.getters.getUserId;const V=a(!1),c=a("");a("");const d=a("");a("");const p=a("");H(["Alice","Bob","Charlie","Diana"]);const L=a(null),w=a(),b=a(!1),q=a(!1),h=a([]),i=a(""),C=a(null),I=a(null),B=()=>{clearTimeout(S),S=setTimeout(R,500)},D=e=>{T.value=e.target.value},U=a(!1),R=async()=>{if(!(i.value.length<3)){U.value=!0;try{const e=await te.get("https://photon.komoot.io/api/",{params:{q:i.value,limit:5}});h.value=e.data.features.map(s=>({display_name:s.properties.housenumber&&s.properties.street?`${s.properties.housenumber} ${s.properties.street}, ${s.properties.city}`:`${s.properties.name}, ${s.properties.city}`,lat:s.geometry.coordinates[1],lon:s.geometry.coordinates[0]}))}catch(e){console.error("Error fetching address suggestions",e)}U.value=!1}};let S=null;const A=e=>{i.value=e.display_name,C.value=e.lat,I.value=e.lon,h.value=[]};J(()=>{l.commit("setLoading",!0)});const n=K(()=>l.getters.getUserDetails);O(async()=>{if(l.commit("setLoading",!0),n.value)c.value=n.value.user.name,i.value=n.value.user.location,d.value=n.value.user.email,p.value=n.value.user.language;else try{await l.dispatch("fetchUserDetails"),c.value=n.value.user.name,i.value=n.value.user.location,d.value=n.value.user.email,p.value=n.value.user.language}catch(e){console.error("Failed to load user details:",e)}l.commit("setLoading",!1)});const M=()=>{L.value.click()},N=e=>{const s=Array.from(e.target.files);s.length>0?(w.value=s,b.value=!0,q.value=!1):(w.value=null,b.value=!1)},P=()=>{$.push({name:"resetPassword"})},x=async()=>{l.commit("setLoading",!0),await F.updateUser({name:c.value,address:{street:i.value,latitude:C.value,longitude:I.value},email:d.value,language:p.value,profileImg:w.value}).then(e=>{e.success?(l.commit("setLoading",!1),m.value="success",g.value=y("User Successfully Updated"),r.value=!0,setTimeout(()=>{r.value=!1},2800),$.push({name:"swaps"})):(l.commit("setLoading",!1),m.value="error",g.value=y("Error Updating User"),r.value=!0,setTimeout(()=>{r.value=!1},2800))}).catch(e=>{l.commit("setLoading",!1),m.value="error",g.value=y("Error Updating User"),r.value=!0,setTimeout(()=>{r.value=!1},2800)})};return(e,s)=>(v(),f("div",ie,[t("div",re,[t("div",{class:"cont_logo selected",id:"ImageInput",onClick:M},[t("i",ue,[t("input",{type:"file",ref_key:"fileInput",ref:L,style:{display:"none"},required:"",onChange:N,accept:"image/*",multiple:""},null,544)])]),t("h1",ce,u(e.$t("Edit Profile")),1),t("form",{onSubmit:Q(x,["prevent"]),class:"form"},[t("div",de,[_(t("input",{type:"text",id:"name","onUpdate:modelValue":s[0]||(s[0]=o=>c.value=o),required:"",class:"inputLogin",placeholder:e.$t("Full Name")},null,8,pe),[[k,c.value]])]),t("div",ve,[_(t("input",{type:"text",id:"city","onUpdate:modelValue":s[1]||(s[1]=o=>i.value=o),onInput:B,disabled:U.value,required:"",class:"inputLogin",placeholder:e.$t("Enter your address")},null,40,me),[[k,i.value]]),h.value.length?(v(),f("div",ge,[(v(!0),f(W,null,X(h.value,(o,j)=>(v(),f("div",{key:j,class:"dropdown-item",onClick:Ce=>A(o)},u(o.display_name),9,he))),128))])):E("",!0)]),t("div",fe,[_(t("input",{type:"email",id:"email","onUpdate:modelValue":s[2]||(s[2]=o=>d.value=o),required:"",class:"inputLogin",placeholder:e.$t("E-mail")},null,8,_e),[[k,d.value]])]),t("div",ye,[_(t("select",{id:"language","onUpdate:modelValue":s[3]||(s[3]=o=>p.value=o),class:"inputLogin",onChange:D},[t("option",we,u(e.$t("Language")),1),t("option",Ue,u(e.$t("English")),1),t("option",ke,u(e.$t("Spanish")),1)],544),[[Y,p.value]])]),t("button",$e,u(e.$t("Confirm")),1),t("p",{class:"reset-password-link",onClick:P},u(e.$t("Reset password")),1)],32)]),V.value?(v(),Z(le,{key:0})):E("",!0),ee(ne,{type:m.value,text:g.value,launch:r.value},null,8,["type","text","launch"])]))}},Ee=G(Le,[["__scopeId","data-v-f4ce9805"]]);export{Ee as default};
