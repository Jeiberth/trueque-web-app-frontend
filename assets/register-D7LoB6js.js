import{_ as j,b as G,r as a,c as f,a as t,w as H,n as J,t as n,e as c,v as _,F as K,k as O,l as Q,m as W,f as X,g as Y,h as Z,p as ee,o as y,u as se,i as te,S as ae}from"./index-CYdO_f1-.js";import{s as le}from"./successErrorCard-CUpuxUch.js";import"./feather-BivZG0He.js";const oe={class:"register-page"},ne={class:"container"},re={"data-feather":"image",class:"iconStyle"},ue={class:"title"},ie={class:"input-group"},de=["placeholder"],ce={class:"input-group address-input"},pe=["disabled","placeholder"],ve={key:0,class:"dropdown"},me=["onClick"],ge={class:"input-group"},he=["placeholder"],fe={class:"input-group"},_e=["placeholder"],ye={class:"input-group"},be={value:"",disabled:""},we={value:"en"},$e={value:"es"},ke={class:"terms-container"},Se={class:"terms-checkbox"},Te={class:"terms-text"},Ce={href:"https://www.trueque.art/#/privacy",target:"_blank"},Ie=["disabled"],Le={__name:"register",setup(Ve){const{t:p,locale:P}=G(),U=new ae,I=se(),u=a("success"),r=a(""),o=a(!1),m=a(!1),L=te(),b=a(""),i=a(""),w=a(""),d=a(""),g=a(""),$=a(null),k=a(null),h=a([]);let V=null;const E=a(null),v=a(),S=a(!1),T=a(!1),q=()=>{E.value.click()},F=e=>{const s=Array.from(e.target.files);s.length>0?(v.value=s,S.value=!0,T.value=!1):(v.value=null,S.value=!1)},N=()=>{clearTimeout(V),V=setTimeout(R,500)},A=()=>{I.push({name:"login"})},M=e=>{P.value=e.target.value},C=a(!1),R=async()=>{if(!(i.value.length<3)){C.value=!0;try{const e=await ee.get("https://photon.komoot.io/api/",{params:{q:i.value,limit:5}});h.value=e.data.features.map(s=>({display_name:s.properties.housenumber&&s.properties.street?`${s.properties.housenumber} ${s.properties.street}, ${s.properties.city}`:`${s.properties.name}, ${s.properties.city}`,lat:s.geometry.coordinates[1],lon:s.geometry.coordinates[0]}))}catch(e){console.error("Error fetching address suggestions",e)}C.value=!1}},x=e=>{i.value=e.display_name,$.value=e.lat,k.value=e.lon,h.value=[]},B=()=>{const e=/.{9,}/,s=/\d/,l=/[!@#$%^&*(),.?":{}|<>]/;return e.test(d.value)&&s.test(d.value)&&l.test(d.value)},D=()=>{if(m.value){if(!B()){r.value=p("Password must be at least 9 characters long and contain at least one symbol and one number."),u.value="error",o.value=!0,setTimeout(()=>{o.value=!1},2800);return}if(!v.value||v.value.length===0){T.value=!0,r.value=p("Please upload a profile image"),u.value="error",o.value=!0,setTimeout(()=>{o.value=!1},2800);return}if(!$.value||!k.value){r.value=p("Please select a valid address from the dropdown."),u.value="error",o.value=!0,setTimeout(()=>{o.value=!1},2800);return}if(!g.value){r.value=p("Please select a language."),u.value="error",o.value=!0,setTimeout(()=>{o.value=!1},2800);return}L.commit("setLoading",!0),U.register({name:b.value,address:{street:i.value,latitude:$.value,longitude:k.value},email:w.value,password:d.value,language:g.value,profileImg:v.value}).then(()=>{u.value="success",r.value=p("Account created! Please verify your email."),o.value=!0,setTimeout(()=>{o.value=!1},2800),I.push({name:"verifyEmail"})}).catch(e=>{r.value=e,o.value=!0,setTimeout(()=>{o.value=!1},2800)}).finally(()=>{L.commit("setLoading",!1)})}};return(e,s)=>(y(),f("div",oe,[t("div",ne,[t("form",{onSubmit:H(D,["prevent"]),class:"form"},[t("div",{class:J(["cont_logo",{selected:S.value,"error-border":T.value}]),id:"ImageInput",onClick:q},[t("i",re,[t("input",{type:"file",ref_key:"fileInput",ref:E,style:{display:"none"},required:"",onChange:F,accept:"image/*",multiple:""},null,544)])],2),t("h1",ue,n(e.$t("Register")),1),t("div",ie,[c(t("input",{type:"text",id:"name","onUpdate:modelValue":s[0]||(s[0]=l=>b.value=l),required:"",class:"inputLogin",placeholder:e.$t("Full Name")},null,8,de),[[_,b.value]])]),t("div",ce,[c(t("input",{type:"text",id:"city","onUpdate:modelValue":s[1]||(s[1]=l=>i.value=l),onInput:N,disabled:C.value,required:"",class:"inputLogin",placeholder:e.$t("Enter your address")},null,40,pe),[[_,i.value]]),h.value.length?(y(),f("div",ve,[(y(!0),f(K,null,O(h.value,(l,z)=>(y(),f("div",{key:z,class:"dropdown-item",onClick:Ee=>x(l)},n(l.display_name),9,me))),128))])):Q("",!0)]),t("div",ge,[c(t("input",{type:"email",id:"email","onUpdate:modelValue":s[2]||(s[2]=l=>w.value=l),required:"",class:"inputLogin",placeholder:e.$t("E-mail")},null,8,he),[[_,w.value]])]),t("div",fe,[c(t("input",{type:"password",id:"password","onUpdate:modelValue":s[3]||(s[3]=l=>d.value=l),required:"",class:"inputLogin",placeholder:e.$t("Password")},null,8,_e),[[_,d.value]])]),t("div",ye,[c(t("select",{id:"language","onUpdate:modelValue":s[4]||(s[4]=l=>g.value=l),class:"inputLogin",onChange:M},[t("option",be,n(e.$t("Language")),1),t("option",we,n(e.$t("English")),1),t("option",$e,n(e.$t("Spanish")),1)],544),[[W,g.value]])]),t("div",ke,[t("label",Se,[c(t("input",{type:"checkbox",id:"terms","onUpdate:modelValue":s[5]||(s[5]=l=>m.value=l)},null,512),[[X,m.value]]),t("span",Te,[Y(n(e.$t("I agree to the"))+" ",1),t("a",Ce,n(e.$t("Terms of Service and Privacy Policy")),1)])])]),t("button",{type:"submit",class:"submit-button",disabled:!m.value},n(e.$t("Sign Up")),9,Ie),t("p",{class:"login-link",onClick:A},n(e.$t("Already have an account?")),1)],32)]),Z(le,{type:u.value,text:r.value,launch:o.value},null,8,["type","text","launch"])]))}},Fe=j(Le,[["__scopeId","data-v-f3c7a726"]]);export{Fe as default};
