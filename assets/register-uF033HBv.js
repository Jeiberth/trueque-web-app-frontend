import{_ as O,b as W,r as l,c as _,a as t,w as j,n as G,t as n,e as v,v as b,F as H,k as J,l as K,m as Q,f as X,g as Y,h as Z,p as ee,o as w,u as se,i as te,S as ae}from"./index-VZJWoiHj.js";import{s as le}from"./successErrorCard-CsDnWBLS.js";import"./feather-DGZv_OKY.js";const oe={class:"register-page"},ne={class:"container"},re={"data-feather":"image",class:"iconStyle"},ue={class:"title"},ie={class:"input-group"},de=["placeholder"],ce={class:"input-group address-input"},pe=["disabled","placeholder"],ve={key:0,class:"dropdown"},me=["onClick"],ge={class:"input-group"},he=["placeholder"],fe={class:"input-group"},ye=["placeholder"],_e={class:"input-group"},be={value:"",disabled:""},we={value:"en"},$e={value:"es"},ke={class:"terms-container"},Te={class:"terms-checkbox"},Ie={class:"terms-text"},Se={href:"https://www.trueque.art/#/privacy",target:"_blank"},Ce=["disabled"],Le={__name:"register",setup(Ve){const{t:i,locale:U}=W(),q=new ae,L=se(),u=l("success"),r=l(""),o=l(!1),m=l(!1),V=te(),$=l(""),d=l(""),k=l(""),c=l(""),g=l(""),T=l(null),I=l(null),h=l([]);let E=null;const P=l(null),p=l(),f=l(!1),y=l(!1),F=()=>{P.value.click()},N=e=>{const s=Array.from(e.target.files);if(s.length>0){if(!s.every(C=>C.type.startsWith("image/"))){r.value=i("Only image files are allowed."),u.value="error",o.value=!0,setTimeout(()=>{o.value=!1},2800),p.value=null,f.value=!1,y.value=!0;return}p.value=s,f.value=!0,y.value=!1}else p.value=null,f.value=!1},A=()=>{clearTimeout(E),E=setTimeout(x,1e3)},M=()=>{L.push({name:"login"})},R=e=>{U.value=e.target.value},S=l(!1),x=async()=>{if(!(d.value.length<3)){S.value=!0;try{const e=await ee.get("https://photon.komoot.io/api/",{params:{q:d.value,limit:5}});h.value=e.data.features.map(s=>({display_name:s.properties.housenumber&&s.properties.street?`${s.properties.housenumber} ${s.properties.street}, ${s.properties.city}`:`${s.properties.name}, ${s.properties.city}`,lat:s.geometry.coordinates[1],lon:s.geometry.coordinates[0]}))}catch(e){console.error("Error fetching address suggestions",e)}S.value=!1}},B=e=>{d.value=e.display_name,T.value=e.lat,I.value=e.lon,h.value=[]},D=()=>{const e=/.{9,}/,s=/\d/,a=/[!@#$%^&*(),.?":{}|<>]/;return e.test(c.value)&&s.test(c.value)&&a.test(c.value)},z=()=>{if(m.value){if(!D()){r.value=i("Password must be at least 9 characters long and contain at least one symbol and one number."),u.value="error",o.value=!0,setTimeout(()=>{o.value=!1},2800);return}if(!p.value||p.value.length===0){y.value=!0,r.value=i("Please upload a profile image"),u.value="error",o.value=!0,setTimeout(()=>{o.value=!1},2800);return}if(!T.value||!I.value){r.value=i("Please select a valid address from the dropdown."),u.value="error",o.value=!0,setTimeout(()=>{o.value=!1},2800);return}if(!g.value){r.value=i("Please select a language."),u.value="error",o.value=!0,setTimeout(()=>{o.value=!1},2800);return}V.commit("setLoading",!0),q.register({name:$.value,address:{street:d.value,latitude:T.value,longitude:I.value},email:k.value,password:c.value,language:g.value,profileImg:p.value}).then(()=>{u.value="success",r.value=i("Account created! Please verify your email."),o.value=!0,setTimeout(()=>{o.value=!1},2800),L.push({name:"verifyEmail"})}).catch(e=>{r.value=e,o.value=!0,setTimeout(()=>{o.value=!1},2800)}).finally(()=>{V.commit("setLoading",!1)})}};return(e,s)=>(w(),_("div",oe,[t("div",ne,[t("form",{onSubmit:j(z,["prevent"]),class:"form"},[t("div",{class:G(["cont_logo",{selected:f.value,"error-border":y.value}]),id:"ImageInput",onClick:F},[t("i",re,[t("input",{type:"file",ref_key:"fileInput",ref:P,style:{display:"none"},required:"",onChange:N,accept:"image/*",multiple:""},null,544)])],2),t("h1",ue,n(e.$t("Register")),1),t("div",ie,[v(t("input",{type:"text",id:"name","onUpdate:modelValue":s[0]||(s[0]=a=>$.value=a),required:"",class:"inputLogin",placeholder:e.$t("Full Name")},null,8,de),[[b,$.value]])]),t("div",ce,[v(t("input",{type:"text",id:"city","onUpdate:modelValue":s[1]||(s[1]=a=>d.value=a),onInput:A,disabled:S.value,required:"",class:"inputLogin",placeholder:e.$t("Enter your address")},null,40,pe),[[b,d.value]]),h.value.length?(w(),_("div",ve,[(w(!0),_(H,null,J(h.value,(a,C)=>(w(),_("div",{key:C,class:"dropdown-item",onClick:Ee=>B(a)},n(a.display_name),9,me))),128))])):K("",!0)]),t("div",ge,[v(t("input",{type:"email",id:"email","onUpdate:modelValue":s[2]||(s[2]=a=>k.value=a),required:"",class:"inputLogin",placeholder:e.$t("E-mail")},null,8,he),[[b,k.value]])]),t("div",fe,[v(t("input",{type:"password",id:"password","onUpdate:modelValue":s[3]||(s[3]=a=>c.value=a),required:"",class:"inputLogin",placeholder:e.$t("Password")},null,8,ye),[[b,c.value]])]),t("div",_e,[v(t("select",{id:"language","onUpdate:modelValue":s[4]||(s[4]=a=>g.value=a),class:"inputLogin",onChange:R},[t("option",be,n(e.$t("Language")),1),t("option",we,n(e.$t("English")),1),t("option",$e,n(e.$t("Spanish")),1)],544),[[Q,g.value]])]),t("div",ke,[t("label",Te,[v(t("input",{type:"checkbox",id:"terms","onUpdate:modelValue":s[5]||(s[5]=a=>m.value=a)},null,512),[[X,m.value]]),t("span",Ie,[Y(n(e.$t("I agree to the"))+" ",1),t("a",Se,n(e.$t("Terms of Service and Privacy Policy")),1)])])]),t("button",{type:"submit",class:"submit-button",disabled:!m.value},n(e.$t("Sign Up")),9,Ce),t("p",{class:"login-link",onClick:M},n(e.$t("Already have an account?")),1)],32)]),Z(le,{type:u.value,text:r.value,launch:o.value},null,8,["type","text","launch"])]))}},Fe=O(Le,[["__scopeId","data-v-13c285b8"]]);export{Fe as default};
