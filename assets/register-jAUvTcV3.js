import{_ as O,b as W,r as l,c as _,a as s,w as j,n as G,t as n,e as v,v as b,F as H,k as J,l as K,m as Q,f as X,g as Y,h as Z,p as ee,o as w,u as te,i as se,S as ae}from"./index-De9TGtBS.js";import{s as le}from"./successErrorCard-B18wESi_.js";import"./feather-DLCu0CSh.js";const oe={class:"register-page"},ne={class:"container"},re={"data-feather":"image",class:"iconStyle"},ue={class:"title"},ie={class:"input-group"},de=["placeholder"],ce={class:"input-group address-input"},pe=["disabled","placeholder"],ve={key:0,class:"dropdown"},me=["onClick"],ge={class:"input-group"},he=["placeholder"],fe={class:"input-group"},ye=["placeholder"],_e={class:"input-group"},be={value:"",disabled:""},we={value:"en"},$e={value:"es"},ke={class:"terms-container"},Te={class:"terms-checkbox"},Ie={class:"terms-text"},Se={href:"https://www.trueque.art/#/privacy",target:"_blank"},Ce=["disabled"],Le={__name:"register",setup(Ve){const{t:i,locale:U}=W(),q=new ae,L=te(),u=l("success"),r=l(""),o=l(!1),m=l(!1),V=se(),$=l(""),d=l(""),k=l(""),c=l(""),g=l(""),T=l(null),I=l(null),h=l([]);let E=null;const P=l(null),p=l(),f=l(!1),y=l(!1),F=()=>{P.value.click()},N=e=>{const t=Array.from(e.target.files);if(t.length>0){if(!t.every(C=>C.type.startsWith("image/"))){r.value=i("Only image files are allowed."),u.value="error",o.value=!0,setTimeout(()=>{o.value=!1},2800),p.value=null,f.value=!1,y.value=!0;return}p.value=t,f.value=!0,y.value=!1}else p.value=null,f.value=!1},A=()=>{clearTimeout(E),E=setTimeout(R,1e3)},x=()=>{L.push({name:"login"})},M=e=>{U.value=e.target.value},S=l(!1),R=async()=>{if(!(d.value.length<3)){S.value=!0;try{const e=await ee.get("https://photon.komoot.io/api/",{params:{q:d.value,limit:5}});h.value=e.data.features.map(t=>({display_name:t.properties.housenumber&&t.properties.street?`${t.properties.housenumber} ${t.properties.street}, ${t.properties.city}`:`${t.properties.name}, ${t.properties.city}`,lat:t.geometry.coordinates[1],lon:t.geometry.coordinates[0]}))}catch(e){console.error("Error fetching address suggestions",e)}S.value=!1}},B=e=>{d.value=e.display_name,T.value=e.lat,I.value=e.lon,h.value=[]},D=()=>{const e=/.{9,}/,t=/\d/,a=/[!@#$%^&*(),.?":{}|<>]/;return e.test(c.value)&&t.test(c.value)&&a.test(c.value)},z=()=>{if(m.value){if(!D()){r.value=i("Password must be at least 9 characters long and contain at least one symbol and one number."),u.value="error",o.value=!0,setTimeout(()=>{o.value=!1},2800);return}if(!p.value||p.value.length===0){y.value=!0,r.value=i("Please upload a profile image"),u.value="error",o.value=!0,setTimeout(()=>{o.value=!1},2800);return}if(!T.value||!I.value){r.value=i("Please select a valid address from the dropdown."),u.value="error",o.value=!0,setTimeout(()=>{o.value=!1},2800);return}if(!g.value){r.value=i("Please select a language."),u.value="error",o.value=!0,setTimeout(()=>{o.value=!1},2800);return}V.commit("setLoading",!0),q.register({name:$.value,address:{street:d.value,latitude:T.value,longitude:I.value},email:k.value,password:c.value,language:g.value,profileImg:p.value}).then(()=>{u.value="success",r.value=i("Account created! Please verify your email."),o.value=!0,setTimeout(()=>{o.value=!1},2800),L.push({name:"verifyEmail"})}).catch(e=>{r.value=e,o.value=!0,setTimeout(()=>{o.value=!1},2800)}).finally(()=>{V.commit("setLoading",!1)})}};return(e,t)=>(w(),_("div",oe,[s("div",ne,[s("form",{onSubmit:j(z,["prevent"]),class:"form"},[s("div",{class:G(["cont_logo",{selected:f.value,"error-border":y.value}]),id:"ImageInput",onClick:F},[s("i",re,[s("input",{type:"file",ref_key:"fileInput",ref:P,style:{display:"none"},required:"",onChange:N,accept:"image/*",multiple:""},null,544)])],2),s("h1",ue,n(e.$t("Register")),1),s("div",ie,[v(s("input",{type:"text",id:"name","onUpdate:modelValue":t[0]||(t[0]=a=>$.value=a),required:"",class:"inputLogin",placeholder:e.$t("Full Name")},null,8,de),[[b,$.value]])]),s("div",ce,[v(s("input",{type:"text",id:"city","onUpdate:modelValue":t[1]||(t[1]=a=>d.value=a),onInput:A,disabled:S.value,required:"",class:"inputLogin",placeholder:e.$t("Enter your approximate address")},null,40,pe),[[b,d.value]]),h.value.length?(w(),_("div",ve,[(w(!0),_(H,null,J(h.value,(a,C)=>(w(),_("div",{key:C,class:"dropdown-item",onClick:Ee=>B(a)},n(a.display_name),9,me))),128))])):K("",!0)]),s("div",ge,[v(s("input",{type:"email",id:"email","onUpdate:modelValue":t[2]||(t[2]=a=>k.value=a),required:"",class:"inputLogin",placeholder:e.$t("E-mail")},null,8,he),[[b,k.value]])]),s("div",fe,[v(s("input",{type:"password",id:"password","onUpdate:modelValue":t[3]||(t[3]=a=>c.value=a),required:"",class:"inputLogin",placeholder:e.$t("Password")},null,8,ye),[[b,c.value]])]),s("div",_e,[v(s("select",{id:"language","onUpdate:modelValue":t[4]||(t[4]=a=>g.value=a),class:"inputLogin",onChange:M},[s("option",be,n(e.$t("Language")),1),s("option",we,n(e.$t("English")),1),s("option",$e,n(e.$t("Spanish")),1)],544),[[Q,g.value]])]),s("div",ke,[s("label",Te,[v(s("input",{type:"checkbox",id:"terms","onUpdate:modelValue":t[5]||(t[5]=a=>m.value=a)},null,512),[[X,m.value]]),s("span",Ie,[Y(n(e.$t("I agree to the"))+" ",1),s("a",Se,n(e.$t("Terms of Service and Privacy Policy")),1)])])]),s("button",{type:"submit",class:"submit-button",disabled:!m.value},n(e.$t("Sign Up")),9,Ce),s("p",{class:"login-link",onClick:x},n(e.$t("Already have an account?")),1)],32)]),Z(le,{type:u.value,text:r.value,launch:o.value},null,8,["type","text","launch"])]))}},Fe=O(Le,[["__scopeId","data-v-43dafb6b"]]);export{Fe as default};
